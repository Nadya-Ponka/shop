<div class="panel panel-default" style="margin-top: 25px;" *ngIf="!showThanks">
  <div class="panel-heading">
    <h4 class="pannel-title">
      Finish your Order
    </h4>
  </div>
  <div class="panel-body">
    <div><strong>Your Order:</strong>
      <div *ngFor="let item of items">
        <td style="padding-right: 25px;">{{item.elem.name | titlecase }}</td>
        <td>{{item.count}} * {{item.elem.price | currency:'EUR'}} = {{item.elem.price * item.count | currency:'EUR'}}
        </td>
      </div>
      <hr>
      <div><strong>Total count of units: </strong>{{ totalCount }}. <strong>Total Cost:
        </strong>{{ totalPrice | currency:'EUR' }}</div>
    </div>
    <hr>
    <br>

    <div class="panel panel-primary">
      <div class="panel-heading">
        Sign Up!
      </div>

      <div class="panel-body">
        <form class="form-horizontal" (ngSubmit)="onSave()" [formGroup]="userForm">
          <fieldset>
            <div class="form-group"
              [ngClass]="{'has-error': (userForm.get('firstName').touched || userForm.get('firstName').dirty) && !userForm.get('firstName').valid }">
              <label class="col-md-2 control-label" for="firstNameId">First Name</label>
              <div class="col-md-8">
                <input class="form-control" id="firstNameId" type="text" placeholder="First Name (required)"
                  formControlName="firstName" />
                <span class="help-block"
                  *ngIf="(userForm.get('firstName').touched || userForm.get('firstName').dirty) && userForm.get('firstName').errors">
                  <span *ngIf="userForm.get('firstName').hasError('required')">
                    Please enter your first name.
                  </span>
                  <span *ngIf="userForm.get('firstName').hasError('minlength')">
                    The first name must be longer than 3 characters.
                  </span>
                </span>

              </div>
            </div>

            <div class="form-group"
              [ngClass]="{'has-error': (userForm.get('lastName').touched || userForm.get('lastName').dirty) && !userForm.get('lastName').valid }">
              <label class="col-md-2 control-label" for="lastNameId">Last Name</label>
              <div class="col-md-8">
                <input class="form-control" id="lastNameId" type="text" placeholder="Last Name"
                  formControlName="lastName" />
              </div>
            </div>

            <div formGroupName="emailGroup" [ngClass]="{'has-error': userForm.get('emailGroup').errors}">
              <!-- Put here email and confirmEmail blocks -->
              <div class="form-group" [ngClass]="{'has-error': validationMessage}">
                <label class="col-md-2 control-label" for="emailId">Email</label>

                <div class="col-md-8">
                  <input class="form-control" id="emailId" type="email" placeholder={{placeholder.email}}
                    formControlName="email" appAsyncEmailValidator (blur)="onBlur()" />
                  <span class="help-block" *ngIf="validationMessage">
                    {{ validationMessage }}
                  </span>
                </div>

                <div class="col-md-8 form-group" [ngClass]="{'has-error': (userForm.get('emailGroup.confirmEmail').touched ||
																	 userForm.get('emailGroup.confirmEmail').dirty) &&
																	 userForm.get('emailGroup.confirmEmail').invalid }">
                  <label class="col-md-2 control-label" for="confirmEmailId">Confirm Email</label>

                  <div class="col-md-8">
                    <input class="form-control" id="confirmEmailId" type="email"
                      placeholder={{placeholder.confirmEmail}} formControlName="confirmEmail" />
                    <span class="help-block" *ngIf="(userForm.get('emailGroup.confirmEmail').touched ||
											userForm.get('emailGroup.confirmEmail').dirty) &&
											(userForm.get('emailGroup.confirmEmail').errors ||
											userForm.get('emailGroup').errors) ">
                      <span *ngIf="userForm.get('emailGroup.confirmEmail').hasError('required')">
                        Please confirm your email address.
                      </span>
                      <span *ngIf="userForm.get('emailGroup').hasError('emailMatch')">
                        The confirmation does not match the email address.
                      </span>
                    </span>

                  </div>
                </div>
              </div>
            </div>

            <div formArrayName="phones">
              <div *ngFor="let phone of phones.controls; let i = index" [formGroupName]="i">

                <div class="form-group">
                  <label class="col-md-2 control-label" for="{{'phoneId' + i}}">Phone #{{i + 1}}</label>
                  <div class="col-md-8">
                    <input class="form-control" id="{{'phoneId' + i}}" type="tel" placeholder={{placeholder.phone}}
											formControlName="phone" />
									</div>
									<div class="col-md-4" *ngIf="phones.controls.length > 1">
											<button class="btn btn-secondary" type="button" (click)="onDeletePhones(i)">
												Delete Phone
											</button>
									</div>
			
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="col-md-4 col-md-offset-2">
                <button class="btn btn-primary" type="button" (click)="onAddPhones()">
                  Add Another Phone number
                </button>
              </div>
            </div>

            <div class="form-group">
              <div class="col-md-offset-1 col-md-8 checkbox">
                <label>
                  <input id="sendProductsId" type="checkbox" formControlName="sendProducts">
                  Take out by yourself
                </label>
              </div>
            </div>

            <div *ngIf="!userForm.get('sendProducts').value">
              <div formArrayName="addresses">
                <div *ngFor="let address of addresses.controls; let i = index" [formGroupName]="i">
                  <div class="form-group">
                    <hr>
                    <label class="col-md-2 control-label">Address Type #{{i + 1}}</label>
                    <div class="col-md-8">
                      <label class="radio-inline">
                        <input type="radio" id="{{'addressType1Id' + i}}" value="home"
                          formControlName="addressType">Home
                      </label>
                      <label class="radio-inline">
                        <input type="radio" id="{{'addressType2Id' + i}}" value="work"
                          formControlName="addressType">Work
                      </label>
                      <label class="radio-inline">
                        <input type="radio" id="{{'addressType3Id' + i}}" value="other"
                          formControlName="addressType">Other
                      </label>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="col-md-2 control-label" attr.for="{{'countryId' + i}}">Country, City, Zip Code</label>

                    <div class="col-md-3">
                      <select class="form-control" id="{{'countryId' + i}}" formControlName="country">
                        <option value="">Select a Country...</option>
                        <option *ngFor="let country of countries" value="{{country}}">{{country}}
                        </option>
                      </select>
                    </div>
                    <div class="col-md-3">
                      <input type="text" class="form-control" id="{{'cityId' + i}}" placeholder="City"
                        formControlName="city">
                    </div>
                    <div class="col-md-2">
                      <input type="number" class="form-control" id="{{'zipId' + i}}" placeholder="Zip Code"
                        formControlName="zip">
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="col-md-2 control-label" attr.for="{{'street1Id' + i}}">Street Address</label>
                    <div class="col-md-8">
                      <input type="text" class="form-control" id="{{'street1Id' + i}}" placeholder="Street address"
                        formControlName="street1">
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <div class="col-md-4 col-md-offset-2">
                  <button class="btn btn-primary" type="button" (click)="onAddAddress()">
                    Add Another Address
                  </button>
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="col-md-4 col-md-offset-2">
                <span>
                  <button class="btn btn-primary" type="submit" [disabled]="!userForm.valid">
                    Save
                  </button>
                </span>
              </div>
            </div>
          </fieldset>
        </form>
      </div>
    </div>

    <br>Dirty: {{ userForm.dirty }}
    <br>Touched: {{ userForm.touched }}
    <br>Valid: {{ userForm.valid }}
    <br>Value: {{ userForm.value | json }}
    <br>Form Status: {{userForm.status }}
    <br>userForm.get('emailGroup').errors {{userForm.get('emailGroup').errors | json}}
    <br>Street: {{addresses.get('0.street1')?.value}}
  </div>
</div>
<div *ngIf="showThanks">
  <h3 style="margin: 25px 0;">Thank you for Shopping!</h3>
  <button class="btn btn-primary" type="button" (click)="onGoBack()">Back to Store</button>
</div>
